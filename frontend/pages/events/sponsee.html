<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Browse Events & Sponsees - SponzoBD</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "Inter", sans-serif;
        overflow-x: hidden;
      }
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #1a1a2e;
      }
      ::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, #ec4899, #f97316);
        border-radius: 10px;
      }
      .page-bg {
        background: linear-gradient(-45deg, #0f0c29, #302b63, #24243e, #1a1a2e);
        background-size: 400% 400%;
        animation: gradientShift 15s ease infinite;
        min-height: 100vh;
      }
      @keyframes gradientShift {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }
      .particles {
        position: fixed;
        width: 100%;
        height: 100%;
        overflow: hidden;
        top: 0;
        left: 0;
        pointer-events: none;
        z-index: 0;
      }
      .particle {
        position: absolute;
        width: 6px;
        height: 6px;
        background: rgba(236, 72, 153, 0.4);
        border-radius: 50%;
        animation: floatParticle 20s infinite;
      }
      .particle:nth-child(1) {
        left: 10%;
        animation-delay: 0s;
        animation-duration: 25s;
      }
      .particle:nth-child(2) {
        left: 25%;
        animation-delay: 2s;
        animation-duration: 20s;
      }
      .particle:nth-child(3) {
        left: 40%;
        animation-delay: 4s;
        animation-duration: 28s;
      }
      .particle:nth-child(4) {
        left: 60%;
        animation-delay: 1s;
        animation-duration: 22s;
      }
      .particle:nth-child(5) {
        left: 80%;
        animation-delay: 3s;
        animation-duration: 18s;
      }
      @keyframes floatParticle {
        0% {
          transform: translateY(100vh) scale(0);
          opacity: 0;
        }
        10% {
          opacity: 1;
        }
        90% {
          opacity: 1;
        }
        100% {
          transform: translateY(-100vh) scale(1);
          opacity: 0;
        }
      }
      .glass-card {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 20px;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }
      .glass-card:hover {
        transform: translateY(-8px);
        border-color: rgba(236, 72, 153, 0.5);
        box-shadow: 0 25px 50px -12px rgba(236, 72, 153, 0.25);
      }
      .gradient-text {
        background: linear-gradient(
          135deg,
          #ec4899 0%,
          #f97316 50%,
          #a855f7 100%
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .orb {
        position: fixed;
        border-radius: 50%;
        filter: blur(80px);
        opacity: 0.3;
        animation: orbFloat 8s ease-in-out infinite;
        pointer-events: none;
        z-index: 0;
      }
      .orb-1 {
        width: 350px;
        height: 350px;
        background: linear-gradient(135deg, #ec4899, #f97316);
        top: -100px;
        right: -100px;
      }
      .orb-2 {
        width: 280px;
        height: 280px;
        background: linear-gradient(135deg, #7c3aed, #a855f7);
        bottom: -80px;
        left: -80px;
        animation-delay: 2s;
      }
      @keyframes orbFloat {
        0%,
        100% {
          transform: translate(0, 0) scale(1);
        }
        50% {
          transform: translate(30px, 30px) scale(1.1);
        }
      }
      .filter-select {
        width: 100%;
        padding: 12px 16px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        font-size: 0.95rem;
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .filter-select:focus {
        outline: none;
        border-color: rgba(236, 72, 153, 0.5);
        box-shadow: 0 0 0 3px rgba(236, 72, 153, 0.1);
      }
      .filter-select option {
        background: #1a1a2e;
        color: white;
      }
      .sponsee-card {
        background: rgba(255, 255, 255, 0.03);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 20px;
        overflow: hidden;
        transition: all 0.4s ease;
      }
      .sponsee-card:hover {
        transform: translateY(-8px);
        border-color: rgba(236, 72, 153, 0.4);
        box-shadow: 0 20px 40px rgba(236, 72, 153, 0.2);
      }
      .sponsee-card:hover img {
        transform: scale(1.1);
      }
      .sponsee-card .img-container {
        overflow: hidden;
      }
      .sponsee-card img {
        transition: all 0.4s ease;
      }
    </style>
  </head>
  <body class="page-bg font-inter">
    <div class="particles">
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
    </div>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>

    <div id="navbar"></div>

    <main class="relative z-10 pt-28 pb-16 px-4">
      <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="mb-12" data-aos="fade-up">
          <span
            class="inline-block px-4 py-2 rounded-full bg-pink-500/10 border border-pink-500/20 text-pink-300 text-sm font-medium mb-4"
          >
            <i class="fas fa-lightbulb mr-2"></i>Find Opportunities
          </span>
          <h1 class="text-4xl md:text-5xl font-bold text-white mb-4 font-space">
            Sponsorship <span class="gradient-text">Opportunities</span>
          </h1>
          <p class="text-gray-400 text-lg">
            Find events and projects that need your sponsorship support
          </p>
        </div>

        <!-- Filters -->
        <div
          class="glass-card p-6 mb-10"
          data-aos="fade-up"
          data-aos-delay="100"
        >
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">
                <i class="fas fa-map-marker-alt mr-2 text-pink-400"></i>Location
              </label>
              <select
                id="location-filter"
                onchange="applyFilters()"
                class="filter-select"
              >
                <option value="all">All Locations</option>
                <option value="dhaka">Dhaka</option>
                <option value="chittagong">Chittagong</option>
                <option value="sylhet">Sylhet</option>
                <option value="rajshahi">Rajshahi</option>
                <option value="gazipur">Gazipur</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">
                <i class="fas fa-tag mr-2 text-purple-400"></i>Category
              </label>
              <select
                id="category-filter"
                onchange="applyFilters()"
                class="filter-select"
              >
                <option value="all">All Categories</option>
                <option value="tech">Technology</option>
                <option value="sports">Sports</option>
                <option value="education">Education</option>
                <option value="health">Health</option>
                <option value="charity">Charity</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">
                <i class="fas fa-money-bill-wave mr-2 text-green-400"></i>Budget
                Range (৳)
              </label>
              <select
                id="budget-filter"
                onchange="applyFilters()"
                class="filter-select"
              >
                <option value="all">All Budgets</option>
                <option value="0-50000">৳0 - ৳50,000</option>
                <option value="50000-100000">৳50,000 - ৳100,000</option>
                <option value="100000-500000">৳100,000 - ৳500,000</option>
                <option value="500000+">৳500,000+</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">
                <i class="fas fa-sort mr-2 text-orange-400"></i>Sort By
              </label>
              <select
                id="sort-by"
                onchange="applyFilters()"
                class="filter-select"
              >
                <option value="newest">Newest First</option>
                <option value="budget-high">Budget: High to Low</option>
                <option value="budget-low">Budget: Low to High</option>
                <option value="attendees">Most Attendees</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Loading State -->
        <div id="loading" class="text-center py-16">
          <div class="inline-flex flex-col items-center">
            <i class="fas fa-spinner fa-spin text-4xl text-pink-400 mb-4"></i>
            <p class="text-gray-400 text-lg">Loading events...</p>
          </div>
        </div>

        <!-- Sponsees Grid -->
        <div
          id="sponsees-grid"
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
        >
          <!-- Sponsee cards will be inserted here -->
        </div>

        <!-- No Results -->
        <div id="no-results" class="hidden text-center py-16">
          <i class="fas fa-search text-5xl text-gray-600 mb-4 block"></i>
          <p class="text-gray-400 text-lg">
            No events found matching your criteria.
          </p>
        </div>
      </div>
    </main>

    <script>
      const API_BASE = "https://test-6aiv.onrender.com/api";
      let allSponsees = [];

      function createSponseeCard(sponsee) {
        const cover =
          sponsee.coverPhoto ||
          "https://images.unsplash.com/photo-1540575467063-178a50c2df87?auto=format&fit=crop&w=800&h=400&q=80";

        return `
          <div class="sponsee-card">
            <div class="img-container h-40 bg-gradient-to-br from-pink-900/50 to-orange-900/50">
              <img src="${cover}" alt="${
          sponsee.eventName
        }" class="w-full h-full object-cover" onerror="this.src='https://images.unsplash.com/photo-1540575467063-178a50c2df87?auto=format&fit=crop&w=800&h=400&q=80'"/>
            </div>
            <div class="p-6">
              <h3 class="text-xl font-semibold text-white mb-2 truncate">${
                sponsee.eventName || "N/A"
              }</h3>
              <p class="text-sm text-pink-400 font-medium mb-4">${
                sponsee.organization || "N/A"
              }</p>
              
              <div class="space-y-3 mb-4 text-sm text-gray-400">
                <div class="flex items-center gap-2">
                  <i class="fas fa-map-marker-alt text-pink-400 w-4"></i>
                  <span>${sponsee.location || "N/A"}</span>
                </div>
                <div class="flex items-center gap-2">
                  <i class="fas fa-users text-purple-400 w-4"></i>
                  <span>${(
                    sponsee.expectedAttendees || 0
                  ).toLocaleString()} attendees</span>
                </div>
                <div class="flex items-center gap-2">
                  <i class="fas fa-envelope text-orange-400 w-4"></i>
                  <span class="truncate">${sponsee.email || "N/A"}</span>
                </div>
              </div>

              <div class="border-t border-white/10 pt-4 mb-4">
                <p class="text-xs text-gray-500 mb-1">Budget Required</p>
                <p class="text-lg font-semibold gradient-text">৳${(
                  sponsee.budget || 0
                ).toLocaleString()}</p>
              </div>

              ${
                sponsee.eventType && sponsee.eventType.length
                  ? `
                <div class="mb-4">
                  <p class="text-xs text-gray-500 mb-2">Event Types</p>
                  <div class="flex flex-wrap gap-2">
                    ${sponsee.eventType
                      .slice(0, 2)
                      .map(
                        (type) =>
                          `<span class="inline-block px-2 py-1 bg-pink-500/20 text-pink-300 text-xs rounded-full border border-pink-500/30">${type}</span>`
                      )
                      .join("")}
                  </div>
                </div>
              `
                  : ""
              }

              <div class="flex gap-3">
                <a href="../profiles/sponsee-profile.html?id=${
                  sponsee._id
                }" class="flex-1 px-4 py-2.5 rounded-xl bg-gradient-to-r from-pink-600 to-orange-600 text-white text-center hover:shadow-lg hover:shadow-pink-500/25 transition font-medium text-sm">
                  <i class="fas fa-eye mr-2"></i>View Details
                </a>
                <a href="mailto:${
                  sponsee.email
                }" class="flex-1 px-4 py-2.5 rounded-xl border border-white/20 text-gray-300 text-center hover:bg-white/10 transition font-medium text-sm">
                  <i class="fas fa-envelope mr-2"></i>Contact
                </a>
              </div>
            </div>
          </div>
        `;
      }

      async function loadSponsees() {
        try {
          const response = await fetch(`${API_BASE}/auth/sponsees`);
          if (!response.ok) throw new Error(`Server error ${response.status}`);

          const data = await response.json();
          allSponsees = data.data || data;

          if (!allSponsees || allSponsees.length === 0) {
            document.getElementById("loading").classList.add("hidden");
            document.getElementById("no-results").classList.remove("hidden");
            return;
          }

          applyFilters();
          document.getElementById("loading").classList.add("hidden");
        } catch (error) {
          console.error("Error loading sponsees:", error);
          document.getElementById("loading").innerHTML = `
            <div class="max-w-md mx-auto glass-card p-8 text-center">
              <i class="fas fa-exclamation-circle text-4xl text-red-400 mb-4 block"></i>
              <p class="text-white font-semibold mb-2">Failed to Load Events</p>
              <p class="text-gray-400 text-sm mb-4">${error.message}</p>
              <button onclick="location.reload()" class="px-6 py-2.5 bg-gradient-to-r from-pink-600 to-orange-600 text-white rounded-xl hover:shadow-lg transition font-medium">
                <i class="fas fa-redo mr-2"></i>Retry
              </button>
            </div>
          `;
        }
      }

      function applyFilters() {
        let filtered = [...allSponsees];
        const locationFilter =
          document.getElementById("location-filter")?.value || "all";
        const categoryFilter =
          document.getElementById("category-filter")?.value || "all";
        const budgetFilter =
          document.getElementById("budget-filter")?.value || "all";
        const sortBy = document.getElementById("sort-by")?.value || "newest";

        if (locationFilter !== "all") {
          filtered = filtered.filter(
            (sponsee) =>
              sponsee.location?.toLowerCase() === locationFilter.toLowerCase()
          );
        }
        if (categoryFilter !== "all") {
          filtered = filtered.filter((sponsee) => {
            if (!sponsee.categories) return false;
            const categories = Array.isArray(sponsee.categories)
              ? sponsee.categories
              : [sponsee.categories];
            return categories.some(
              (cat) => cat.toLowerCase() === categoryFilter.toLowerCase()
            );
          });
        }
        if (budgetFilter !== "all") {
          const budgetRanges = {
            "0-50000": [0, 50000],
            "50000-100000": [50000, 100000],
            "100000-500000": [100000, 500000],
            "500000+": [500000, Infinity],
          };
          const [min, max] = budgetRanges[budgetFilter] || [0, Infinity];
          filtered = filtered.filter((sponsee) => {
            const budget = sponsee.budget || 0;
            return budget >= min && budget <= max;
          });
        }

        switch (sortBy) {
          case "budget-high":
            filtered.sort((a, b) => (b.budget || 0) - (a.budget || 0));
            break;
          case "budget-low":
            filtered.sort((a, b) => (a.budget || 0) - (b.budget || 0));
            break;
          case "attendees":
            filtered.sort(
              (a, b) => (b.expectedAttendees || 0) - (a.expectedAttendees || 0)
            );
            break;
          case "newest":
          default:
            filtered.sort(
              (a, b) => new Date(b.createdAt) - new Date(a.createdAt)
            );
        }

        const grid = document.getElementById("sponsees-grid");
        const noResults = document.getElementById("no-results");

        if (filtered.length === 0) {
          grid.classList.add("hidden");
          noResults.classList.remove("hidden");
        } else {
          grid.innerHTML = filtered
            .map((sponsee) => createSponseeCard(sponsee))
            .join("");
          grid.classList.remove("hidden");
          noResults.classList.add("hidden");
        }
      }

      window.addEventListener("DOMContentLoaded", loadSponsees);
      AOS.init({ duration: 800, easing: "ease-out-cubic", once: true });
    </script>

    <script src="../../components/navbar.js"></script>
  </body>
</html>
